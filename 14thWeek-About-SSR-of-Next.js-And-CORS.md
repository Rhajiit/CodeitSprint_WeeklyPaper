# CodeitSprint_WeeklyPaper-14th

## Next.js에서의 SSR을 시행하는 과정과 hydration

### Next.js에서 SSR을 실행하는 과정

1. 필요한 데이터를 백엔드 서버에 요청함.
2. 받은 데이터를 이용하여 프론트 서버에서 HTML파일을 생성.
3. 요청한 페이지에 필요한 HTML, CSS, JavaScript 코드를 브라우저에 전송.
4. 사용자에게 상호작용이 불가한 HTML, CSS 화면 노출.
5. 리액트 hydrate 이후 사용자 상호작용 가능.

### hydration

#### 서버에서 렌더링된 HTML에 기반하여 클라이언트 측에서 JavaScript 이벤트와 상태를 연결하는 과정.

hydration이 없다면 서버측에서 렌더링된 HTML을 무시하고 클라이언트 측에서 불필요한 렌더링이 필요 - hydration을 통해 이러한 과정을 효율적으로 처리함.

리액트는 hydrate 할 때, 렌더링된 콘텐츠가 서버와 클라이언트 간에 동일한 것으로 예상함. - 개발자 모드에서 불일치가 발생하는 경우 리액트는 불일치에 대해 경고할 뿐, 일치를 위해 차이를 고쳐주지 않음!

- 대부분 불일치가 발생하는 경우가 많지 않음.
- 발생 시 모든 내용을 검증하는 큰 비용이 드는 작업으로 성능상 문제.

이러한 문제는 Next.js에서도 발생하여, SSG 또는 SSR로 서버측에서 렌더링된 리액트 트리와 브라우저에서 처음 렌더링한 리액트 트리가 다른 경우 에러를 발생.

hydration 에러를 마주하지 않으려면 컴포넌트를 만들때 window 분기로 렌더링에 차이가 발생하지 않도록 해야함.

## CORS 에러의 상세 내용과과 해결방법

### CORS란?

#### Cross-Origin Resource Sharing, 서로 다른 출처에서 리소스를 공유하여 한 출처에 있는 자원에서 다른 출처에 있는 자원에 접근하도록 함,

#### 동일 출처 정책(Same-Origin Policy)

프로토콜, 호스트, 포트를 합쳐서 출처(Origin)라고 함.

어떤 출처에서 불러온 문서나 스크립트가 다른 출처에서 가져온 리소스와 상호작용하는 것을 제한하는 중요한 보안 방식.
이 정책은 잠재적으로 해로울 수 있는 문서를 분리함으로써 공격받을 수 있는 경로룰 줄여줌 - 사용자 보안을 위해 브라우저에 기본 구현됨.

웹 애플리케이션을 만들 때, 출처가 다른 자원들을 가져와 사용해야 하는 경우 CORS 설정이 필요. - 이러한 설정은 자원을 제공하는 백엔드 서버에서 허용된 출처라 명시함으로 회피 가능.

Next.js에서 서로 다른 출처에서 리소스를 공유하려고 하면 브라우저에서 동일 출처 정책에 따라 CORS 에러 발생 가능.

#### CORS 에러 해결

1. 백엔드 서버 개발자에게 에러가 발생하는 출처를 허용하도록 Access-Control-Allow-Origin 설정을 요청
2. 설정 요청을 할 수 없는 경우, 동일 출처 정책을 강제하지 않는 proxy 서버를 활용해 우회 - Next.js의 rewrite
