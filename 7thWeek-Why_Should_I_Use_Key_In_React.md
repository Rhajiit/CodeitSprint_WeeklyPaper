# CodeitSprint_WeeklyPaper-7th

About Reason of using key

## Reason of Key using in React

리액트에서는 수많은 목록을 렌더링 할 때, 서버로 Request를 보내 데이터를 Response로 받아온다. 이때 자바스크립트에서 객체와 비슷한 형식으 이루어져 있으며, 실제로도 객체로 변환 가능한 Json 데이터를 받아오는데, 자바스크립트에서는 이를 객체로 변환한 이후 map을 통해 필요한 데이터를 분해하여 배열로서 이를 다룬다.

하지만 HTML, Vanilla javaScript에서 배열을 다룰 때 key라는 존재를 중요하게 여기진 않았는데, 그때에는 고정된 데이터만을 다루며, 서버의 데이터 변형에 따른 순서 변형을 고려하지 않았기 때문이다. Key라는 개념은 데이터의 고유성을 기억하여 서버에서 데이터를 받아와 제거하거나 새로 생성한 것을 파악하는데 주요한 요소이다.

### if 'key' is not used in React

실제 서버에 삭제 요청을 보냄과 동시에 데이터를 받아와 다시 배열을 재렌더링하면 좋겠지만, 인터넷이 좋지 않은 환경에서는 이러한 대기 시간이 사용자 피로감을 높일 가능성이 크다. 따라서 실제로 처리되지는 않았으나 웹페이지에서는 즉각적으로 변화를 줄 필요성이 있는데, 이때 리액트에서는 useState라는 함수를 이용해 이러한 상태변화 및 재렌더링 여부를 판단한다.

이때 배열을 변경하는 과정에서 재귀적으로 처리하는 과정 중, 변경 전과 후의 두 리스트를 순회하고 차이점이 있을 경우에 변경하여 렌더링을 실시하는데, 리스트의 마지막 요소를 추가하는 경우에는 큰 문제가 없지만 리스트의 맨 앞에 엘리먼트를 추가하는 경우에도 전체 리스트를 확인하며, 이 과정에서 비효율적인 순환이 시작된다.
소규모 프로젝트의 경우에는 당장의 큰 문제가 없겠지만, 그 검증 개수와 복잡성이 늘어감에 따라 매우 비생산적인 코드가 될 수 있다.

이를 해결하기 위한 한 방책으로, 리액트에서는 key를 이용한다. key 는 리액트가 어떤 항목을 변경, 추가 또는 삭제할지 식별하는 것을 돕는데, 고유성을 부여하기 위해 배열 내부의 각 요소에 정해줘야 한다.
key 는 리스트의 다른 항목들 사이에서 해당 항목을 고유하게 식별할 수 있는 문자열을 사용하는 것이 가장 좋으며, 모든 배열 내에서 특정한 한 요소를 가리키는 key를 지정하는것이 아닌, 각 배열에서 고유한 key를 이용하면 된다. 이때, 일반적으로는 id를 이용한다.

### index could be a Key?

인덱스를 key로 사용할 경우, 배열을 재배열 하였을 때 내부 요소에 해당하는 key 값 또한 바뀐다. 컴포넌트는 key를 기반으로 갱신되기 때문에 배열 요소의 key(index) 값이 바뀌면서 컴포넌트의 state가 꼬이거나 의도하지 않은 방식으로 바뀌는 문제가 발생할 수 있다.

### index could be a Key!

그러나 key 요소로 지정할 요소가 마땅히 없어 이러한 index를 불가피하게 사용해야 할 때가 있는데, 이때는 다음의 세 가지 요건을 만족시킬 때 쓰는 것이 좋다.

- 배열의 항목들에 계산 요소가 들어가지 않아 그 상태가 변형되지 않고 유지될 때
- 렌더링할 항목에 안정적으로 지정할 id와 같은 요소가 없을 것
- 배열의 재배열이나 필터 기능을 쓰지 않을 것

다만, 이렇게 index를 key로 사용하는 것 자체가 현명하지 못하기 때문에, 이를 해결할 uuid 또는 nanoid 같은 고유 id를 생성해주는 패키지를 사용하는 것이 좋다.
